# -*- coding: utf-8 -*-
"""Copy of BYOP'Mid-Evaluation.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/15UpFSvJ7RmpHrV8RE_YTiOJmbbL9fX0P

Loading the libraries
"""

import matplotlib.pyplot as plt # plotting the statistical distribution
import numpy as np # for linear algebra
import os # accessing directory structure
import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)
import gensim
from gensim import corpora #to construct the corpus matrix for LDA model
import re #for regular words
import seaborn as sns #visualising data as graphs

"""# Dataset Loading"""

from google.colab import drive
drive.mount('/content/drive')

df = pd.read_csv('/content/drive/MyDrive/BYOPVasu Khanna/Restaurant_reviews_dataset.csv')

"""Printing the dataset"""

df

"""# Dataset Visualisation"""

import matplotlib.pyplot as plt 
import seaborn as sns
#For Displaying the first 5 rows of the DataFrame
print(df.head())

#For Displaying the shape of the DataFrame
print(df.shape)

#For Checking the data types of each column
print(df.dtypes)

#For Checking for missing values
print(df.isnull().sum())

#For Generating descriptive statistics for numerical columns
print(df.describe())

# Plotting a histogram of a numerical column
plt.hist(df['Liked'], bins=10)
plt.title('Likes & Dislikes visualisation')
plt.xlabel('Rating')
plt.ylabel('Number of reviews')
plt.show()

# Generating a boxplot of a numerical column
sns.boxplot(x=df['Liked'])
plt.title('Boxplot of Likes')
plt.xlabel('Column')
plt.show()

# Generating a correlation matrix of numerical columns
corr_matrix = df.corr()
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm')
plt.title('Correlation Matrix')
plt.show()

# Creating a pairplot of numerical columns
sns.pairplot(df)
plt.title('Pairplot')
plt.show()

# Generating a bar chart of categorical columns
df['Liked'].value_counts().plot(kind='bar')
plt.title('Bar Chart of Column')
plt.xlabel('Column')
plt.ylabel('Frequency')
plt.show()

"""Here, I was facing error in accessing the review column of the dataset because of an extra 'space' present with the word ' Review'. So, I figured it out first after facing "Attribute not found error" & then renamed it to "Review"
"""

df.columns

df = df.rename(columns={' Review': 'Review'})

"""### Changed the Data present in the review column into a list"""

data = df.Review.values.tolist()
data

"""Removing the unwanted characters, expressions & symbols & then printing the dataset"""

import re
df['Review'] = df['Review'].str.replace("[^a-zA-Z#]", " ")
df

"""Storing the data now obtained in a new dataframe named 'data'"""

data = df.Review.values.tolist()
data



"""# Data Cleaning

Importing NLTK library for data cleaning & downloading stopwords from the NLTK library
"""


 
 
of
moods

 
This
is
a
good
joint

 
The
Macarons
here
are
insanely
good

 
I
m
not
eating
here

 
Our
waiter
was
very
attentive
 
friendly
 
and
informative

 
Maybe
if
they
weren
t
cold
they
would
have
been
somewhat
edible

 
This
place
has
a
lot
of
promise
but
fails
to
deliver

 
Very
bad
Experience

 
What
a
mistake

 
Food
was
average
at
best

 
Great
food

 
We
won
t
be
going
back
anytime
soon

 
Very
Very
Disappointed
ordered
the
    
Big
Bay
Plater

 
Great
place
to
relax
and
have
an
awesome
burger
and
beer

 
It
is
PERFECT
for
a
sit
down
family
meal
or
get
together
with
a
few
friends

 
Not
much
flavor
to
them
 
and
very
poorly
constructed

 
The
patio
seating
was
very
comfortable

 
The
fried
rice
was
dry
as
well

 
Hands
down
my
favorite
Italian
restaurant

 
That
just
SCREAMS
 
LEGIT
 
in
my
book
  
somethat
s
also
pretty
rare
here
in
Vegas

 
It
was
just
not
a
fun
experience

 
The
atmosphere
was
great
with
a
lovely
duo
of
violinists
playing
songs
we
requested

 
I
personally
love
the
hummus
 
pita
 
baklava
 
falafels
and
Baba
Ganoush
 
it
s
amazing
what
they
do
with
eggplant
  
 
Very
convenient
 
since
we
were
staying
at
the
MGM

 
The
owners
are
super
friendly
and
the
staff
is
courteous

 
Both
great

 
Eclectic
selection

 
The
sweet
potato
tots
were
good
but
the
onion
rings
were
perfection
or
as
close
as
I
have
had

 
The
staff
was
very
attentive

 
And
the
chef
was
generous
with
his
time
 
even
came
around
twice
so
we
can
take
pictures
with
him
 
 
The
owner
used
to
work
at
Nobu
 
so
this
place
is
really
similar
for
half
the
price

 
Google
mediocre
and
I
imagine
Smashburger
will
pop
up

 
do
nt
go
here

 
I
promise
they
won
t
disappoint

 
As
a
sushi
lover
avoid
this
place
by
all
means

 
What
a
great
double
cheeseburger

 
Awesome
service
and
food

 
A
fantastic
neighborhood
gem
   
 
I
can
t
wait
to
go
back

 
The
plantains
were
the
worst
I
ve
ever
tasted

 
It
s
a
great
place
and
I
highly
recommend
it

 
Service
was
slow
and
not
attentive

 
I
gave
it
  
stars
then
 
and
I
m
giving
it
  
stars
now

 
Your
staff
spends
more
time
talking
to
themselves
than
me

 
Dessert
 
Panna
Cotta
was
amazing

 
Very
good
food
 
great
atmosphere
 
 
Damn
good
steak

 
Total
brunch
fail

 
Prices
are
very
reasonable
 
flavors
are
spot
on
 
the
sauce
is
home
made
 
and
the
slaw
is
not
drenched
in
mayo

 
The
decor
is
nice
 
and
the
piano
music
soundtrack
is
pleasant

 
The
steak
was
amazing
  
rge
fillet
relleno
was
the
best
seafood
plate
i
have
ever
had

 
Good
food
  
good
service
 
 
It
was
absolutely
amazing

 
I
probably
won
t
be
back
 
to
be
honest

 
will
definitely
be
back

 
The
sergeant
pepper
beef
sandwich
with
auju
sauce
is
an
excellent
sandwich
as
well

 
Hawaiian
Breeze
 
Mango
Magic
 
and
Pineapple
Delight
are
the
smoothies
that
I
ve
tried
so
far
and
they
re
all
good

 
Went
for
lunch
  
service
was
slow

 
We
had
so
much
to
say
about
the
place
before
we
walked
in
that
he
expected
it
to
be
amazing
 
but
was
quickly
disappointed

 
I
was
mortified

 
Needless
to
say
 
we
will
never
be
back
here
again

 
Anyways
 
The
food
was
definitely
not
filling
at
all
 
and
for
the
price
you
pay
you
should
expect
more

 
The
chips
that
came
out
were
dripping
with
grease
 
and
mostly
not
edible

 
I
wasn
t
really
impressed
with
Strip
Steak

 
Have
been
going
since
     
and
every
meal
has
been
awesome
 
 
Our
server
was
very
nice
and
attentive
as
were
the
other
serving
staff

 
The
cashier
was
friendly
and
even
brought
the
food
out
to
me

 
I
work
in
the
hospitality
industry
in
Paradise
Valley
and
have
refrained
from
recommending
Cibo
any
longer

 
The
atmosphere
here
is
fun

 
Would
not
recommend
to
others

 
Service
is
quick
and
even
 
to
go
 
orders
are
just
like
we
like
it

 
I
mean
really
 
how
do
you
get
so
famous
for
your
fish
and
chips
when
it
s
so
terrible
  
 
That
said
 
our
mouths
and
bellies
were
still
quite
pleased

 
Not
my
thing

   
Thumbs
Up
 
 
If
you
are
reading
this
please
don
t
go
there

 
I
loved
the
grilled
pizza
 
reminded
me
of
legit
Italian
pizza

 
Only
Pros
  
Large
seating
area
 
Nice
bar
area
 
Great
simple
drink
menu
 
The
BEST
brick
oven
pizza
with
homemade
dough

 
They
have
a
really
nice
atmosphere

 
Tonight
I
had
the
Elk
Filet
special
  
and
it
sucked

 
After
one
bite
 
I
was
hooked

 
We
ordered
some
old
classics
and
some
new
dishes
after
going
there
a
few
times
and
were
sorely
disappointed
with
everything

 
Cute
 
quaint
 
simple
 
honest

 
The
chicken
was
deliciously
seasoned
and
had
the
perfect
fry
on
the
outside
and
moist
chicken
on
the
inside

 
The
food
was
great
as
always
 
compliments
to
the
chef

 
Special
thanks
to
Dylan
T
 
for
the
recommendation
on
what
to
order
   
All
yummy
for
my
tummy

 
Awesome
selection
of
beer

 
Great
food
and
awesome
service

 
One
nice
thing
was
that
they
added
gratuity
on
the
bill
since
our
party
was
larger
than
  
or
   
and
they
didn
t
expect
more
tip
than
that

 
A
FLY
was
in
my
apple
juice
  
A
FLY
       
 
The
Han
Nan
Chicken
was
also
very
tasty

 
As
for
the
service
 
I
thought
it
was
good

 
The
food
was
barely
lukewarm
 
so
it
must
have
been
sitting
waiting
for
the
server
to
bring
it
out
to
us

 
Ryan
s
Bar
is
definitely
one
Edinburgh
establishment
I
won
t
be
revisiting

 
Nicest
Chinese
restaurant
I
ve
been
in
a
while

 
Overall
 
I
like
there
food
and
the
service

 
They
also
now
serve
Indian
naan
bread
with
hummus
and
some
spicy
pine
nut
sauce
that
was
out
of
this
world

 
Probably
never
coming
back
 
and
wouldn
t
recommend
it

 
Friend
s
pasta
   
also
bad
 
he
barely
touched
it

 
Try
them
in
the
airport
to
experience
some
tasty
food
and
speedy
 
friendly
service

 
I
love
the
decor
with
the
Chinese
calligraphy
wall
paper

 
Never
had
anything
to
complain
about
here

 
The
restaurant
is
very
clean
and
has
a
family
restaurant
feel
to
it

 
It
was
way
over
fried

 
I
m
not
sure
how
long
we
stood
there
but
it
was
long
enough
for
me
to
begin
to
feel
awkwardly
out
of
place

 
When
I
opened
the
sandwich
 
I
was
impressed
 
but
not
in
a
good
way

 
Will
not
be
back

 
There
was
a
warm
feeling
with
the
service
and
I
felt
like
their
guest
for
a
special
treat

 
An
extensive
menu
provides
lots
of
options
for
breakfast

 
I
always
order
from
the
vegetarian
menu
during
dinner
 
which
has
a
wide
array
of
options
to
choose
from

 
I
have
watched
their
prices
inflate
 
portions
get
smaller
and
management
attitudes
grow
rapidly

 
Wonderful
lil
tapas
and
the
ambience
made
me
feel
all
warm
and
fuzzy
inside

 
I
got
to
enjoy
the
seafood
salad
 
with
a
fabulous
vinegrette

 
The
wontons
were
thin
 
not
thick
and
chewy
 
almost
melt
in
your
mouth

 
Level
  
spicy
was
perfect
 
where
spice
didn
t
over
whelm
the
soup

 
We
were
sat
right
on
time
and
our
server
from
the
get
go
was
FANTASTIC

 
Main
thing
I
didn
t
enjoy
is
that
the
crowd
is
of
older
crowd
 
around
mid
  
s
and
up

 
When
I
m
on
this
side
of
town
 
this
will
definitely
be
a
spot
I
ll
hit
up
again

 
I
had
to
wait
over
   
minutes
to
get
my
drink
and
longer
to
get
  
arepas

 
This
is
a
GREAT
place
to
eat

 
The
jalapeno
bacon
is
soooo
good

 
The
service
was
poor
and
that
s
being
nice

 
Food
was
good
 
service
was
good
 
Prices
were
good

 
The
place
was
not
clean
and
the
food
oh
so
stale

 
The
chicken
dishes
are
OK
 
the
beef
is
like
shoe
leather

 
But
the
service
was
beyond
bad

 
I
m
so
happy
to
be
here
   
 
Tasted
like
dirt

 
One
of
the
few
places
in
Phoenix
that
I
would
definately
go
back
to
again
 
 
The
block
was
amazing

 
It
s
close
to
my
house
 
it
s
low
key
 
non
fancy
 
affordable
prices
 
good
food

   
Both
the
Hot
  
Sour
  
the
Egg
Flower
Soups
were
absolutely
  
Stars

 
My
sashimi
was
poor
quality
being
soggy
and
tasteless

 
Great
time
  
family
dinner
on
a
Sunday
night

 
the
food
is
not
tasty
at
all
 
not
to
say
its
 
real
traditional
Hunan
style
 
 
What
did
bother
me
 
was
the
slow
service

 
The
flair
bartenders
are
absolutely
amazing

 
Their
frozen
margaritas
are
WAY
too
sugary
for
my
taste

 
These
were
so
good
we
ordered
them
twice

 
So
in
a
nutshell
    
The
restaraunt
smells
like
a
combination
of
a
dirty
fish
market
and
a
sewer

 
My
girlfriend
s
veal
was
very
bad

 
Unfortunately
 
it
was
not
good

 
I
had
a
pretty
satifying
experience

 
Join
the
club
and
get
awesome
offers
via
email

 
Perfect
for
someone
 
me
 
who
only
likes
beer
ice
cold
 
or
in
this
case
 
even
colder

 
Bland
and
flavorless
is
a
good
way
of
describing
the
barely
tepid
meat

 
The
chains
 
which
I
m
no
fan
of
 
beat
this
place
easily

 
The
nachos
are
a
MUST
HAVE

 
We
will
not
be
coming
back

 
I
don
t
have
very
many
words
to
say
about
this
place
 
but
it
does
everything
pretty
well

 
The
staff
is
super
nice
and
very
quick
even
with
the
crazy
crowds
of
the
downtown
juries
 
lawyers
 
and
court
staff

 
Great
atmosphere
 
friendly
and
fast
service

 
When
I
received
my
Pita
it
was
huge
it
did
have
a
lot
of
meat
in
it
so
thumbs
up
there

 
Once
your
food
arrives
it
s
meh

 
Paying
      
for
a
hot
dog
and
fries
that
looks
like
it
came
out
of
a
kid
s
meal
at
the
Wienerschnitzel
is
not
my
idea
of
a
good
meal

 
The
classic
Maine
Lobster
Roll
was
fantastic

 
My
brother
in
law
who
works
at
the
mall
ate
here
same
day
 
and
guess
what
he
was
sick
all
night
too

 
So
good
I
am
going
to
have
to
review
this
place
twice
  
once
hereas
a
tribute
to
the
place
and
once
as
a
tribute
to
an
event
held
here
last
night

 
The
chips
and
salsa
were
really
good
 
the
salsa
was
very
fresh

 
This
place
is
great
             
 
Mediocre
food

 
Once
you
get
inside
you
ll
be
impressed
with
the
place

 
I
m
super
pissd

 
And
service
was
super
friendly

 
Why
are
these
sad
little
vegetables
so
overcooked

 
This
place
was
such
a
nice
surprise

 
They
were
golden
crispy
and
delicious

 
I
had
high
hopes
for
this
place
since
the
burgers
are
cooked
over
a
charcoal
grill
 
but
unfortunately
the
taste
fell
flat
 
way
flat

 
I
could
eat
their
bruschetta
all
day
it
is
devine

 
Not
a
single
employee
came
out
to
see
if
we
were
OK
or
even
needed
a
water
refill
once
they
finally
served
us
our
food

 
Lastly
 
the
mozzarella
sticks
 
they
were
the
best
thing
we
ordered

 
The
first
time
I
ever
came
here
I
had
an
amazing
experience
 
I
still
tell
people
how
awesome
the
duck
was

 
The
server
was
very
negligent
of
our
needs
and
made
us
feel
very
unwelcome
   
I
would
not
suggest
this
place

 
The
service
was
terrible
though

 
This
place
is
overpriced
 
not
consistent
with
their
boba
 
and
it
really
is
OVERPRICED

 
It
was
packed
 
 
I
love
this
place

 
I
can
say
that
the
desserts
were
yummy

 
The
food
was
terrible

 
The
seasonal
fruit
was
fresh
white
peach
puree

 
It
kept
getting
worse
and
worse
so
now
I
m
officially
done

 
This
place
should
honestly
be
blown
up

 
But
I
definitely
would
not
eat
here
again

 
Do
not
waste
your
money
here

 
I
love
that
they
put
their
food
in
nice
plastic
containers
as
opposed
to
cramming
it
in
little
paper
takeout
boxes

 
The
cr
pe
was
delicate
and
thin
and
moist

 
Awful
service

 
Won
t
ever
go
here
again

 
Food
quality
has
been
horrible

 
For
that
price
I
can
think
of
a
few
place
I
would
have
much
rather
gone

 
The
service
here
is
fair
at
best

 
I
do
love
sushi
 
but
I
found
Kabuki
to
be
over
priced
 
over
hip
and
under
services

 
Do
yourself
a
favor
and
stay
away
from
this
dish

 
Very
poor
service

 
No
one
at
the
table
thought
the
food
was
above
average
or
worth
the
wait
that
we
had
for
it

 
Best
service
and
food
ever
 
Maria
our
server
was
so
good
and
friendly
she
made
our
day

 
They
were
excellent

 
I
paid
the
bill
but
did
not
tip
because
I
felt
the
server
did
a
terrible
job

 
Just
had
lunch
here
and
had
a
great
experience

 
I
have
never
had
such
bland
food
which
surprised
me
considering
the
article
we
read
focused
so
much
on
their
spices
and
flavor

 
Food
is
way
overpriced
and
portions
are
fucking
small

 
I
recently
tried
Caballero
s
and
I
have
been
back
every
week
since

 
for
   
bucks
a
head
 
i
really
expect
better
food

 
The
food
came
out
at
a
good
pace

 
I
ate
there
twice
on
my
last
visit
 
and
especially
enjoyed
the
salmon
salad

 
I
won
t
be
back

 
We
could
not
believe
how
dirty
the
oysters
were

 
This
place
deserves
no
stars

 
I
would
not
recommend
this
place

 
In
fact
I
m
going
to
round
up
to
  
stars
 
just
because
she
was
so
awesome

 
To
my
disbelief
 
each
dish
qualified
as
the
worst
version
of
these
foods
I
have
ever
tasted

 
Bad
day
or
not
 
I
have
a
very
low
tolerance
for
rude
customer
service
people
 
it
is
your
job
to
be
nice
and
polite
 
wash
dishes
otherwise
 
 
the
potatoes
were
great
and
so
was
the
biscuit

 
I
probably
would
not
go
here
again

 
So
flavorful
and
has
just
the
perfect
amount
of
heat

 
The
price
is
reasonable
and
the
service
is
great

 
The
Wife
hated
her
meal
 
coconut
shrimp
  
and
our
friends
really
did
not
enjoy
their
meals
 
either

 
My
fella
got
the
huevos
rancheros
and
they
didn
t
look
too
appealing

 
Went
in
for
happy
hour
 
great
list
of
wines

 
Some
may
say
this
buffet
is
pricey
but
I
think
you
get
what
you
pay
for
and
this
place
you
are
getting
quite
a
lot

 
I
probably
won
t
be
coming
back
here

 
Worst
food
service
I
ve
had
in
a
while

 
This
place
is
pretty
good
 
nice
little
vibe
in
the
restaurant

 
Talk
about
great
customer
service
of
course
we
will
be
back

 
Hot
dishes
are
not
hot
 
cold
dishes
are
close
to
room
temp
I
watched
staff
prepare
food
with
BARE
HANDS
 
no
gloves
Everything
is
deep
fried
in
oil

 
I
love
their
fries
and
their
beans

 
Always
a
pleasure
dealing
with
him

 
They
have
a
plethora
of
salads
and
sandwiches
 
and
everything
I
ve
tried
gets
my
seal
of
approval

 
This
place
is
awesome
if
you
want
something
light
and
healthy
during
the
summer

 
For
sushi
on
the
Strip
 
this
is
the
place
to
go

 
The
service
was
great
 
even
the
manager
came
and
helped
with
our
table

 
The
feel
of
the
dining
room
was
more
college
cooking
course
than
high
class
dining
and
the
service
was
slow
at
best

 
I
started
this
review
with
two
stars
 
but
I
m
editing
it
to
give
it
only
one

 
this
is
the
worst
sushi
i
have
ever
eat
besides
Costco
s

 
All
in
all
an
excellent
restaurant
highlighted
by
great
service
 
a
unique
menu
 
and
a
beautiful
setting

 
My
boyfriend
and
i
sat
at
the
bar
and
had
a
completely
delightful
experience

 
Weird
vibe
from
owners

 
There
was
hardly
any
meat

 
I
ve
had
better
bagels
from
the
grocery
store

 
Go
To
Place
for
Gyros

 
I
love
the
owner
chef
 
his
one
authentic
Japanese
cool
dude

 
Now
the
burgers
aren
t
as
good
 
the
pizza
which
used
to
be
amazing
is
doughy
and
flavorless

 
I
found
a
six
inch
long
piece
of
wire
in
my
salsa

 
The
service
was
terrible
 
food
was
mediocre

 
We
definately
enjoyed
ourselves

 
I
ordered
Albondigas
soup
  
which
was
just
warm
  
and
tasted
like
tomato
soup
with
frozen
meatballs

 
On
three
different
occasions
I
asked
for
well
done
or
medium
well
 
and
all
three
times
I
got
the
bloodiest
piece
of
meat
on
my
plate

 
I
had
about
two
bites
and
refused
to
eat
anymore

 
The
service
was
extremely
slow

 
After
   
minutes
wait
 
I
got
a
table

 
Seriously
killer
hot
chai
latte

 
No
allergy
warnings
on
the
menu
 
and
the
waitress
had
absolutely
no
clue
as
to
which
meals
did
or
did
not
contain
peanuts

 
My
boyfriend
tried
the
Mediterranean
Chicken
Salad
and
fell
in
love

 
Their
rotating
beers
on
tap
is
also
a
highlight
of
this
place

 
Pricing
is
a
bit
of
a
concern
at
Mellow
Mushroom

 
Worst
Thai
ever

 
If
you
stay
in
Vegas
you
must
get
breakfast
here
at
least
once

 
I
want
to
first
say
our
server
was
great
and
we
had
perfect
service

 
The
pizza
selections
are
good

 
I
had
strawberry
tea
 
which
was
good

 
Highly
unprofessional
and
rude
to
a
loyal
patron

 
Overall
 
a
great
experience

 
Spend
your
money
elsewhere

 
Their
regular
toasted
bread
was
equally
satisfying
with
the
occasional
pats
of
butter
   
Mmmm
   
 
The
Buffet
at
Bellagio
was
far
from
what
I
anticipated

 
And
the
drinks
are
WEAK
 
people

  
My
order
was
not
correct

 
Also
 
I
feel
like
the
chips
are
bought
 
not
made
in
house

 
After
the
disappointing
dinner
we
went
elsewhere
for
dessert

 
The
chips
and
sals
a
here
is
amazing
                  
 
We
won
t
be
returning

 
This
is
my
new
fav
Vegas
buffet
spot

 
I
seriously
can
not
believe
that
the
owner
has
so
many
unexperienced
employees
that
all
are
running
around
like
chickens
with
their
heads
cut
off

 
Very
 
very
sad

 
i
felt
insulted
and
disrespected
 
how
could
you
talk
and
judge
another
human
being
like
that

 
How
can
you
call
yourself
a
steakhouse
if
you
can
t
properly
cook
a
steak
 
I
don
t
understand

 
I
m
not
impressed
with
the
concept
or
the
food

 
The
only
thing
I
wasn
t
too
crazy
about
was
their
guacamole
as
I
don
t
like
it
pur
ed

 
There
is
really
nothing
for
me
at
postinos
 
hope
your
experience
is
better

 
I
got
food
poisoning
here
at
the
buffet

 
They
brought
a
fresh
batch
of
fries
and
I
was
thinking
yay
something
warm
but
no

 
What
SHOULD
have
been
a
hilarious
 
yummy
Christmas
Eve
dinner
to
remember
was
the
biggest
fail
of
the
entire
trip
for
us

 
Needless
to
say
 
I
won
t
be
going
back
anytime
soon

 
This
place
is
disgusting

 
Every
time
I
eat
here
 
I
see
caring
teamwork
to
a
professional
degree

 
The
RI
style
calamari
was
a
joke

 
However
 
there
was
so
much
garlic
in
the
fondue
 
it
was
barely
edible

 
I
could
barely
stomach
the
meal
 
but
didn
t
complain
because
it
was
a
business
lunch

 
It
was
so
bad
 
I
had
lost
the
heart
to
finish
it

 
It
also
took
her
forever
to
bring
us
the
check
when
we
asked
for
it

 
We
aren
t
ones
to
make
a
scene
at
restaurants
but
I
just
don
t
get
it
  
definitely
lost
the
love
after
this
one

 
Disappointing
experience

 
The
food
is
about
on
par
with
Denny
s
 
which
is
to
say
 
not
good
at
all

 
If
you
want
to
wait
for
mediocre
food
and
downright
terrible
service
 
then
this
is
the
place
for
you

 
WAAAAAAyyyyyyyyyy
over
rated
is
all
I
am
saying

 
We
won
t
be
going
back

 
The
place
was
fairly
clean
but
the
food
simply
wasn
t
worth
it

 
This
place
lacked
style
 
 
The
sangria
was
about
half
of
a
glass
wine
full
and
was
     
ridiculous

 
Don
t
bother
coming
here

 
The
meat
was
pretty
dry
 
I
had
the
sliced
brisket
and
pulled
pork

 
The
building
itself
seems
pretty
neat
 
the
bathroom
is
pretty
trippy
 
but
I
wouldn
t
eat
here
again

 
It
was
equally
awful

 
Probably
not
in
a
hurry
to
go
back

 
very
slow
at
seating
even
with
reservation

 
Not
good
by
any
stretch
of
the
imagination

 
The
cashew
cream
sauce
was
bland
and
the
vegetables
were
undercooked

 
The
chipolte
ranch
dipping
sause
was
tasteless
 
seemed
thin
and
watered
down
with
no
heat

 
It
was
a
bit
too
sweet
 
not
really
spicy
enough
 
and
lacked
flavor

 
I
was
VERY
disappointed
 
 
This
place
is
horrible
and
way
overpriced

 
Maybe
it
s
just
their
Vegetarian
fare
 
but
I
ve
been
twice
and
I
thought
it
was
average
at
best

 
It
wasn
t
busy
at
all
and
now
we
know
why

 
The
tables
outside
are
also
dirty
a
lot
of
the
time
and
the
workers
are
not
always
friendly
and
helpful
with
the
menu

 
The
ambiance
here
did
not
feel
like
a
buffet
setting
 
but
more
of
a
douchey
indoor
garden
for
tea
and
biscuits

 
Con
 
spotty
service

 
The
fries
were
not
hot
 
and
neither
was
my
burger

 
But
then
they
came
back
cold

 
Then
our
food
came
out
 
disappointment
ensued

 
The
real
disappointment
was
our
waiter

 
My
husband
said
she
was
very
rude
   
did
not
even
apologize
for
the
bad
food
or
anything

 
The
only
reason
to
eat
here
would
be
to
fill
up
before
a
night
of
binge
drinking
just
to
get
some
carbs
in
your
stomach

 
Insults
 
profound
deuchebaggery
 
and
had
to
go
outside
for
a
smoke
break
while
serving
just
to
solidify
it

 
If
someone
orders
two
tacos
don
t
 
you
think
it
may
be
part
of
customer
service
to
ask
if
it
is
combo
or
ala
cart

 
She
was
quite
disappointed
although
some
blame
needs
to
be
placed
at
her
door

 
After
all
the
rave
reviews
I
couldn
t
wait
to
eat
here
     
what
a
disappointment

 
Del
Taco
is
pretty
nasty
and
should
be
avoided
if
possible

 
It
s
NOT
hard
to
make
a
decent
hamburger

 
But
I
don
t
like
it

 
Hell
no
will
I
go
back

 
We
ve
have
gotten
a
much
better
service
from
the
pizza
place
next
door
than
the
services
we
received
from
this
restaurant

 
I
don
t
know
what
the
big
deal
is
about
this
place
 
but
I
won
t
be
back
 
ya
all
 
 
I
immediately
said
I
wanted
to
talk
to
the
manager
but
I
did
not
want
to
talk
to
the
guy
who
was
doing
shots
of
fireball
behind
the
bar

 
The
ambiance
isn
t
much
better

 
Unfortunately
 
it
only
set
us
up
for
disapppointment
with
our
entrees

 
The
food
wasn
t
good

 
Your
servers
suck
 
wait
 
correction
 
our
server
Heimer
sucked

 
What
happened
next
was
pretty
   
off
putting

 
too
bad
cause
I
know
it
s
family
owned
 
I
really
wanted
to
like
this
place

 
Overpriced
for
what
you
are
getting

 
I
vomited
in
the
bathroom
mid
lunch

 
I
kept
looking
at
the
time
and
it
had
soon
become
   
minutes
 
yet
still
no
food

 
I
have
been
to
very
few
places
to
eat
that
under
no
circumstances
would
I
ever
return
to
 
and
this
tops
the
list

 
We
started
with
the
tuna
sashimi
which
was
brownish
in
color
and
obviously
wasn
t
fresh

 
Food
was
below
average

 
It
sure
does
beat
the
nachos
at
the
movies
but
I
would
expect
a
little
bit
more
coming
from
a
restaurant

 
All
in
all
 
Ha
Long
Bay
was
a
bit
of
a
flop

 
The
problem
I
have
is
that
they
charge
       
for
a
sandwich
that
is
no
bigger
than
a
Subway
sub
 
which
offers
better
and
more
amount
of
vegetables
 
 
Shrimp
 
When
I
unwrapped
it
 
I
live
only
    
a
mile
from
Brushfire
 
it
was
literally
ice
cold

 
It
lacked
flavor
 
seemed
undercooked
 
and
dry

 
It
really
is
impressive
that
the
place
hasn
t
closed
down

 
I
would
avoid
this
place
if
you
are
staying
in
the
Mirage

 
The
refried
beans
that
came
with
my
meal
were
dried
out
and
crusty
and
the
food
was
bland

 
Spend
your
money
and
time
some
place
else

 
A
lady
at
the
table
next
to
us
found
a
live
green
caterpillar
In
her
salad

 
the
presentation
of
the
food
was
awful

 
I
can
t
tell
you
how
disappointed
I
was

 
I
think
food
should
have
flavor
and
texture
and
both
were
lacking

 
Appetite
instantly
gone

 
Overall
I
was
not
impressed
and
would
not
go
back

 
The
whole
experience
was
underwhelming
 
and
I
think
we
ll
just
go
to
Ninja
Sushi
next
time

 
Then
 
as
if
I
hadn
t
wasted
enough
of
my
life
there
 
they
poured
salt
in
the
wound
by
drawing
out
the
time
it
took
to
bring
the
check"""

#nlp.Defaults.stop_words.add('I')
nlp.vocab['I'].is_stop = True

stop_words = set(stopwords.words('english'))

reviews = word_tokenize(reviews_stopwords_removed)
# converts the words in word_tokens to lower case and then checks whether
#they are present in stop_words or not
filtered_reviews = [w for w in reviews if not w.lower() in stop_words]
#with no lower case conversion

for w in reviews:
	if w not in stop_words:
		filtered_reviews.append(w)
	
print(reviews)

import matplotlib.pyplot as plt
from collections import Counter


new_list = [word for word in filtered_reviews if len(word) >3]
print(new_list)

words = new_list
word_counts = Counter(words)
top_words = word_counts.most_common(20)

# Plotting 30 most frequent words from the filtered_reviews set
plt.bar( [w[0] for w in top_words],[w[1] for w in top_words])
plt.xticks(rotation=45, ha='right')
plt.xlabel('Word')
plt.ylabel('Count')
plt.title('20 Most frequently occurinng words')
plt.show()

#Tokenize the sentence into words
tokens = [word for word in reviews_stopwords_removed.split()]
from gensim import corpora
from gensim.models.ldamodel import LdaModel

    #Create dictionary
dictionary = corpora.Dictionary([tokens])
print(dictionary)

# print(dictionary.id2token) ## to see the actual dictionary generated
corpus = [dictionary.doc2bow(reviews_stopwords_removed) for text in reviews] ## document to bag of words

# fit LDA model
transcripts_topics = LdaModel(corpus=corpus,
                           id2word=dictionary,
                           num_topics=30,
                           alpha='auto', ##Learns an asymmetric prior from the corpus;
##1D array of length=number of expected topics that expresses our a-priori belief for the each topics’ probability.
                           passes=100 ##Number of passes through the corpus during training.
                             ) 
print(transcripts_topics)
# print out first 5 topics
for i, topic in enumerate(transcripts_topics.print_topics(5)):
    print ('%d: %s\n'%(i+1, topic))

# Build the bigram and trigram models
bigram = gensim.models.Phrases(new_list, min_count=5, threshold=100) # higher threshold fewer phrases.
trigram = gensim.models.Phrases(bigram[new_list], threshold=100)  

# See trigram example
print(bigram_mod[new_list])
